{"version":3,"sources":["controllers-rossia.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","angular","component","templateUrl","2","3","controller","controllerAs","bindings","rfisc","active","disabled","4","MealRossiyaController","$scope","$element","backend","utils","switchService","vm","locked","checkServiceRemovalProhibited","service","selectFirstAvailablePassengerFlight","removeExtraService","mealCountChangeHandler","subgroupNum","mealItem","delta","modifyExtraService","passenger_id","orderInfo","passengers","selectedPassenger","id","segment_id","plainFlights","selectedFlight","subgroup","subgroups","amount","alreadySelectedCount","service_type","serviceType","getLimitStatus","selectFlightPassenger","flightNum","passengerNum","updateMealMenu","getFirstAvailableFlightNum","getFirstAvailablePassengerNum","mealMenu","itemsByPassengerSegments","undefined","mealMenuSubgroup","setPassengerFlightMeal","selectedPassengerFlightMeal","getSelectedPassengerFlightMeal","newMealParams","then","removePassengerFlightMeal","result","passengerSegmentServices","passengerSegmentMeal","editableExtraServicesByPassengers","_","findWhere","serviceItem","scrollToStart","passengersTableContainer","scrollTo","scrollToEnd","scrollWidth","mobileTableScrollHandler","scrollLeft","clientWidth","scrollRight","canScrollRight","canScrollLeft","$apply","availableBySegments","availableByPassengerSegments","checkAllChoose","j","countMeals","mealsIssued","groupedIssuedExtraServices","meal","forEach","arr","item","getMealInfo","obj","infoMeal","group","splitMeal","selectedMeal","map","selectedMealPassenger","selectedMealPassengerSegment","newMealList","selectedMealItem","tmpItem","copy","totalPrice","Big","div","toFixed","push","this","find","hasAlias","getAvailablePassengersCount","getParam","mealImagesPath","addOrderInfoListener","groupedEditableExtraServices","$watch","on","5","SeatRossiyaController","$timeout","modifyError","clearFlightPassenger","editable_extra_services","resp","error","seatMap","setSeatMapContainerTopPosition","reset","seatMapContainerTopPosition","jQuery","css","updateSeatMap","loadingSeatMap","seatMapError","hasSeatsWithBabyBassinet","checkExistSeatsWithBabyBassinetBySeatMap","babyBassinetCost","getBabyBassinetCost","paxNum","babyBassinetItem","babyBassinetService","getFirstNotEmptySubListItem","price","currency","value","hasBabyBassinet","decks","deck","cabins","cabin","rows","row","chairs","chair","checkExistSeatsWithBabyBassinetByChair","properties","prop","setPassengerFlightSeat","cabinAllowed","rowNumber","paxId","segId","available","number","commonSubgroup","removeBabyBassinetIfExist","updateSunInfoByFlights","sunInfoByFlights","flight","sunInfo","origincity","departuredate","departuretime","destinationcity","arrivaldate","arrivaltime","getAvailablePassengersCountWrap","count","filter","pax","hasSeats","removePassengerFlightSeat","editableExtraServicesHeap","groupCode","mainSegmentId","passengerId","passengerSegmentSeat","6","OrderRossiyaController","$window","redirect","fancyboxTools","retryPayment","loading","retryRegister","lastName","pnr","location","errorMessage","bindOrder","header","regnum","bindAlowed","showBindOrderSuccessMessage","showBindOrderFailMessage","checkAllPassengersHavePaidService","name","passenger","allExtraServicesByPassengers","segmentServices","segmentWantedService","status","clearSession","goToSearchOrder","openExchange","goToExchange","openRefund","goToRefund","openAddServices","goToAddServices","suffixCount","searchOrder","pnrOrTicketNumber","resultParam","getParamFromLocation","waitPayment","hasFailedServices","showPaymentFrame","openHandler","submitCallback","paymentRedirectTo","ignoreFailedServices","disableOutsideCloseClick","hasBonusCard","ffpSumm","ffpBonus","total","7","PopupMealRossiyaController","setItemIndex","subgroupIndex","mealIndex","detailedView","open","closeItemPopup","nextItemPopup","countSubgroupIndex","countMealIndex","prevItemPopup","setAvailablePassengers","availablePassengers","index","currentFlightIndex","mealMenuSubgroupMobileChange","mealMenuSubgroupMobile","switchNext","successSwitch","currentPassengerIndex","switchPrev","arrayString","arrays","Array","isArray","reduce","flat","current","concat","getGroupMeal","totalAmount","totalSumm","close","fancybox","subgroupItems","createOptionsForUiSelect","clearPassengerFlightMeal","getPassengerFlightMeal","mealSelect","8","./components/baby-bassinet-icon-legend/baby-bassinet-icon-legend","./components/baby-bassinet-icon-tooltip/baby-bassinet-icon-tooltip","./components/baby-bassinet-icon/baby-bassinet-icon","./components/es-meal-rossiya/es-meal-rossiya","./components/es-seat-rossiya/es-seat-rossiya","./components/order-rossiya/order-rossiya","./components/popup-meal-rossiya/popup-meal-rossiya"],"mappings":"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","file":"controllers-rossia.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\nangular.module('app').component('babyBassinetIconLegend', {\n    templateUrl: 'components/baby-bassinet-icon-legend/baby-bassinet-icon-legend.html'\n});\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\nangular.module('app').component('babyBassinetIconTooltip', {\n    templateUrl: 'components/baby-bassinet-icon-tooltip/baby-bassinet-icon-tooltip.html'\n});\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\nangular.module('app').component('babyBassinetIcon', {\n    templateUrl: 'components/baby-bassinet-icon/baby-bassinet-icon.html',\n    controller: function () {},\n    controllerAs: 'vm',\n    bindings: {\n        rfisc: '=rfisc',\n        active: '=active',\n        disabled: '=disabled'\n    }\n});\n\n\n\n},{}],4:[function(require,module,exports){\n\"use strict\";\nangular.module('app').component('esMealRossiya', {\n    templateUrl: 'components/es-meal-rossiya/es-meal-rossiya.html',\n    controller: ['$scope', '$element','backend', 'utils', MealRossiyaController],\n    controllerAs: 'vm',\n    bindings: {\n        service: '=service',\n        locked: '=locked'\n    }\n});\n\nfunction MealRossiyaController($scope, $element, backend, utils) {\n\n    var vm = this,\n        passengersTableContainer = $element.find('div.passengersTableContainer');\n\n    vm.switchService = switchService;\n    vm.selectFlightPassenger = selectFlightPassenger;\n    vm.selectFirstAvailablePassengerFlight = selectFirstAvailablePassengerFlight;\n    vm.setPassengerFlightMeal = setPassengerFlightMeal;\n    vm.removePassengerFlightMeal = removePassengerFlightMeal;\n    vm.getSelectedPassengerFlightMeal = getSelectedPassengerFlightMeal;\n    vm.scrollToStart = scrollToStart;\n    vm.scrollToEnd = scrollToEnd;\n    vm.checkAllChoose = checkAllChoose;\n    vm.mealCountChangeHandler = mealCountChangeHandler;\n    vm.hasAlias = backend.hasAlias;\n    vm.getAvailablePassengersCount = utils.getAvailablePassengersCount;\n    vm.checkServiceRemovalProhibited = backend.checkServiceRemovalProhibited;\n    vm.getLimitStatus = getLimitStatus;\n    vm.getMealInfo = getMealInfo;\n\n    vm.canScrollRight = true;\n    vm.canScrollLeft = false;\n\n    vm.selectedFlight = 0;\n    vm.selectedPassenger = 0;\n\n    if (backend.getParam('site.externalStorageBaseUrl')) {\n        vm.mealImagesPath = backend.getParam('site.externalStorageBaseUrl') + '/img/content/meal';\n    } else {\n        vm.mealImagesPath = './themes/websky/assets/static/img/content/meal';\n    }\n\n    backend.addOrderInfoListener(function (orderInfo) {\n        if (\n            orderInfo &&\n            orderInfo.groupedEditableExtraServices &&\n            orderInfo.groupedEditableExtraServices.meal\n        ) {\n            orderInfo.groupedEditableExtraServices.meal = splitMeal(orderInfo.groupedEditableExtraServices.meal);\n        }\n        vm.orderInfo = orderInfo;\n    }, false, true);\n\n    $scope.$watch('vm.service', function () {\n        if (vm.mealMenu) {\n            updateMealMenu();\n        }\n    });\n\n    passengersTableContainer.on('scroll', mobileTableScrollHandler);\n\n    if (vm.service.active) {\n        updateMealMenu();\n    }\n\n    function switchService() {\n        if (!vm.locked && !backend.checkServiceRemovalProhibited('meal')) {\n            vm.service.active = !vm.service.active;\n            if (vm.service.active) {\n                selectFirstAvailablePassengerFlight();\n            } else {\n                backend.removeExtraService({\n                    code: 'meal'\n                });\n            }\n        }\n    }\n\n    function mealCountChangeHandler(subgroupNum, mealItem, delta) {\n\n      if(delta < 0) {\n        if (!vm.locked) {\n            backend.modifyExtraService({\n                code: 'meal',\n                passenger_id: vm.orderInfo.passengers[vm.selectedPassenger].id,\n                segment_id: vm.orderInfo.plainFlights[vm.selectedFlight].id,\n                subgroup: vm.service.subgroups[subgroupNum],\n                amount: (mealItem.alreadySelectedCount || 0) + delta,\n                service_type: mealItem.serviceType,\n                rfisc: mealItem.rfisc\n            });\n        }\n      }\n\n      // if countSumm for all meal > limit, don't plus\n      if(!getLimitStatus() && delta > 0) {\n        if (!vm.locked) {\n            backend.modifyExtraService({\n                code: 'meal',\n                passenger_id: vm.orderInfo.passengers[vm.selectedPassenger].id,\n                segment_id: vm.orderInfo.plainFlights[vm.selectedFlight].id,\n                subgroup: vm.service.subgroups[subgroupNum],\n                amount: (mealItem.alreadySelectedCount || 0) + delta,\n                service_type: mealItem.serviceType,\n                rfisc: mealItem.rfisc\n            });\n        }\n      }\n\n    }\n\n    function selectFlightPassenger(flightNum, passengerNum) {\n        vm.selectedFlight = flightNum;\n        vm.selectedPassenger = passengerNum;\n        updateMealMenu();\n    }\n\n    function selectFirstAvailablePassengerFlight() {\n        vm.selectedFlight = getFirstAvailableFlightNum();\n        vm.selectedPassenger = getFirstAvailablePassengerNum(vm.selectedFlight);\n        updateMealMenu();\n    }\n\n    function updateMealMenu() {\n        vm.mealMenu = vm.service.itemsByPassengerSegments[vm.selectedPassenger][vm.selectedFlight];\n        if (vm.mealMenuSubgroup === undefined) {\n            vm.mealMenuSubgroup = false;\n        }\n    }\n\n    function setPassengerFlightMeal(subgroupNum, mealItem) {\n        var selectedPassengerFlightMeal = getSelectedPassengerFlightMeal(vm.selectedPassenger, vm.selectedFlight),\n            newMealParams = {\n                code: 'meal',\n                passenger_id: vm.orderInfo.passengers[vm.selectedPassenger].id,\n                segment_id: vm.orderInfo.plainFlights[vm.selectedFlight].id,\n                subgroup: vm.service.subgroups[subgroupNum],\n                service_type: mealItem.serviceType,\n                rfisc: mealItem.rfisc\n            };\n        if (!vm.locked) {\n            if (\n                selectedPassengerFlightMeal &&\n                !backend.checkServiceRemovalProhibited('meal', vm.selectedPassenger, vm.selectedFlight)\n            ) {\n                backend.removeExtraService({\n                    code: 'meal',\n                    passenger_id: vm.orderInfo.passengers[vm.selectedPassenger].id,\n                    segment_id: vm.orderInfo.plainFlights[vm.selectedFlight].id,\n                    service_type: selectedPassengerFlightMeal.serviceType,\n                    rfisc: selectedPassengerFlightMeal.rfisc\n                }, true).then(function () {\n                    backend.modifyExtraService(newMealParams);\n                });\n            } else {\n                backend.modifyExtraService(newMealParams);\n            }\n        }\n    }\n\n    function removePassengerFlightMeal(passengerNum, flightNum) {\n        if (!vm.locked && !backend.checkServiceRemovalProhibited('meal', passengerNum, flightNum)) {\n            backend.removeExtraService({\n                code: 'meal',\n                passenger_id: vm.orderInfo.passengers[passengerNum].id,\n                segment_id: vm.orderInfo.plainFlights[flightNum].id\n            });\n        }\n    }\n\n    function getSelectedPassengerFlightMeal(passengerNum, flightNum) {\n        var result,\n            passengerSegmentServices,\n            passengerSegmentMeal;\n        if (vm.orderInfo.editableExtraServicesByPassengers) {\n            if (vm.orderInfo.editableExtraServicesByPassengers[passengerNum]) {\n                /* jshint maxlen: 150 */\n                passengerSegmentServices = vm.orderInfo.editableExtraServicesByPassengers[passengerNum].passengerSegmentServices[flightNum];\n                if (passengerSegmentServices) {\n                    passengerSegmentMeal = _.findWhere(passengerSegmentServices, { code: 'meal' });\n                    if (passengerSegmentMeal) {\n                        result = passengerSegmentMeal.serviceItem;\n                    }\n                }\n            }\n        }\n        return result;\n    }\n\n    function scrollToStart() {\n        passengersTableContainer.scrollTo(0);\n    }\n\n    function scrollToEnd() {\n        passengersTableContainer.scrollTo(passengersTableContainer[0].scrollWidth);\n    }\n\n    function mobileTableScrollHandler() {\n        var scrollLeft = passengersTableContainer[0].scrollLeft,\n            scrollWidth = passengersTableContainer[0].scrollWidth,\n            clientWidth = passengersTableContainer[0].clientWidth,\n            scrollRight = scrollWidth - clientWidth - scrollLeft;\n        vm.canScrollRight = (scrollRight !== 0);\n        vm.canScrollLeft = (scrollLeft !== 0);\n        $scope.$apply();\n    }\n\n    function getFirstAvailableFlightNum() {\n        var i;\n        for (i = 0; i < vm.orderInfo.plainFlights.length; i++) {\n            if (vm.service.availableBySegments[i]) {\n                return i;\n            }\n        }\n        return -1;\n    }\n\n    function getFirstAvailablePassengerNum(flightNum) {\n        var i;\n        if (vm.service.availableByPassengerSegments) {\n            for (i = 0; i < vm.orderInfo.passengers.length; i++) {\n                if (vm.service.availableByPassengerSegments[i][flightNum]) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    }\n\n    function checkAllChoose() {\n\n      for (var i = 0; i < vm.orderInfo.plainFlights.length; i++) {\n        for (var j = 0; j < vm.orderInfo.passengers.length; j++) {\n          if (getSelectedPassengerFlightMeal(j, i)) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n\n    }\n\n    function getLimitStatus() {\n      var countMeals = 0,\n          selectedPassenger = vm.selectedPassenger || 0,\n          selectedFlight = vm.selectedFlight || 0,\n          mealsIssued = vm.orderInfo.groupedIssuedExtraServices.meal[selectedPassenger][selectedFlight].length || 0;\n\n      vm.mealMenu.forEach(function(arr) {\n        arr.forEach(function(item) {\n          countMeals += item.alreadySelectedCount;\n        });\n      });\n\n      countMeals += mealsIssued;\n\n      return (countMeals >= 3) ? true : false;\n    }\n\n    function getMealInfo(obj) {\n      var infoMeal = {\n        group: 0,\n        meal: {}\n      }\n\n      for (var i = 0; i < vm.mealMenu.length; i++) {\n        for (var j = 0; j < vm.mealMenu[i].length; j++) {\n          if(vm.mealMenu[i][j].rfisc == obj.rfisc) {\n            infoMeal.meal = vm.mealMenu[i][j];\n            infoMeal.group = i;\n          }\n        }\n      }\n\n      return infoMeal;\n    }\n\n    function splitMeal(selectedMeal) {\n        if (selectedMeal && selectedMeal.length) {\n            selectedMeal = selectedMeal.map(function (selectedMealPassenger) {\n                if (selectedMealPassenger && selectedMealPassenger.length) {\n                    selectedMealPassenger = selectedMealPassenger.map(function (selectedMealPassengerSegment) {\n                        var newMealList = [];\n                        if (selectedMealPassengerSegment && selectedMealPassengerSegment.length) {\n                            selectedMealPassengerSegment.forEach(function (selectedMealItem) {\n                                var tmpItem;\n                                if (selectedMealItem && selectedMealItem.amount) {\n                                    tmpItem = angular.copy(selectedMealItem);\n                                    tmpItem.amount = 1;\n                                    tmpItem.totalPrice = Big(selectedMealItem.totalPrice).div(selectedMealItem.amount).toFixed(2);\n                                    for (var i=0; i<selectedMealItem.amount; i++) {\n                                        newMealList.push(tmpItem);\n                                    }\n                                }\n                            });\n                            selectedMealPassengerSegment = newMealList;\n                        }\n                        return selectedMealPassengerSegment;\n                    });\n                }\n                return selectedMealPassenger;\n            });\n        }\n        return selectedMeal;\n    }\n\n}\n\n},{}],5:[function(require,module,exports){\n\"use strict\";\nangular.module('app').component('esSeatRossiya', {\n    templateUrl: 'components/es-seat-rossiya/es-seat-rossiya.html',\n    controller: ['$scope', '$element', '$timeout', 'backend', 'utils', SeatRossiyaController],\n    controllerAs: 'vm',\n    bindings: {\n        service: '=service',\n        babyBassinetService: '=',\n        locked: '=locked'\n    }\n});\n\nfunction SeatRossiyaController($scope, $element, $timeout, backend, utils) {\n\n    var vm = this,\n        passengersTableContainer = $element.find('div.passengersTableContainer'),\n        seatMapContainerTopPosition = '0px';\n\n    vm.switchService = switchService;\n\n    vm.selectFlightPassenger = selectFlightPassenger;\n    vm.selectFirstAvailablePassengerFlight = selectFirstAvailablePassengerFlight;\n    vm.setPassengerFlightSeat = setPassengerFlightSeat;\n    vm.getSelectedPassengerFlightMeal = getSelectedPassengerFlightMeal;\n    vm.checkAllChoose = checkAllChoose;\n\n    vm.hasAlias = backend.hasAlias;\n\n    vm.scrollToStart = scrollToStart;\n    vm.scrollToEnd = scrollToEnd;\n\n    vm.getAvailablePassengersCount = utils.getAvailablePassengersCount;\n    vm.getAvailablePassengersCountWrap = getAvailablePassengersCountWrap;\n\n    vm.removePassengerFlightSeat = removePassengerFlightSeat;\n\n    vm.checkServiceRemovalProhibited = backend.checkServiceRemovalProhibited;\n\n    vm.canScrollRight = true;\n    vm.canScrollLeft = false;\n\n    backend.addOrderInfoListener(function (orderInfo) {\n        vm.orderInfo = orderInfo;\n    }, false, true);\n\n    updateSunInfoByFlights();\n\n    passengersTableContainer.on('scroll', mobileTableScrollHandler);\n\n    if (vm.service.active) {\n        selectFirstAvailablePassengerFlight();\n    }\n\n    function switchService() {\n        if (!vm.locked && !backend.checkServiceRemovalProhibited('seat')) {\n            vm.service.active = !vm.service.active;\n            if (vm.service.active) {\n                selectFirstAvailablePassengerFlight();\n            } else {\n                vm.modifyError = false;\n                backend.removeExtraService({\n                    code: 'seat'\n                }).then(function () {\n                    clearFlightPassenger();\n                    if (\n                        vm.orderInfo.editable_extra_services &&\n                        _.findWhere(vm.orderInfo.editable_extra_services, { code: 'babyBassinet' })\n                    ) {\n                        backend.removeExtraService({\n                            code: 'babyBassinet'\n                        })\n                    }\n                }, function (resp) {\n                    if (resp.error) {\n                        vm.modifyError = resp.error;\n                    }\n                });\n            }\n        }\n    }\n\n    function clearFlightPassenger() {\n        vm.seatMap = false;\n        vm.selectedFlight = -1;\n        vm.selectedPassenger = -1;\n    }\n\n    function setSeatMapContainerTopPosition(reset) {\n        if (reset) {\n            seatMapContainerTopPosition = '0px';\n        } else {\n            seatMapContainerTopPosition = jQuery('.passengersSeatMap').find('.mCSB_container').css('top');\n        }\n    }\n\n    function selectFlightPassenger(flightNum, passengerNum) {\n        // Нужно запомнить положение карты мест для переключения между пассажирами одного сегмента\n        setSeatMapContainerTopPosition(vm.selectedFlight !== flightNum);\n        vm.selectedFlight = flightNum;\n        vm.selectedPassenger = passengerNum;\n        updateSeatMap();\n    }\n\n    function selectFirstAvailablePassengerFlight() {\n        vm.selectedFlight = getFirstAvailableFlightNum();\n        vm.selectedPassenger = getFirstAvailablePassengerNum(vm.selectedFlight);\n        updateSeatMap();\n    }\n\n    function updateSeatMap() {\n\n        if (vm.selectedPassenger !== -1 && vm.selectedFlight !== -1) {\n            vm.loadingSeatMap = true;\n            vm.seatMapError = false;\n            backend.seatMap(\n                vm.orderInfo.passengers[vm.selectedPassenger].id,\n                vm.orderInfo.plainFlights[vm.selectedFlight].id\n            ).then(function (resp) {\n                vm.seatMap = resp;\n                vm.seatMap.hasSeatsWithBabyBassinet = checkExistSeatsWithBabyBassinetBySeatMap(resp);\n                if (vm.seatMap.hasSeatsWithBabyBassinet) {\n                    vm.seatMap.babyBassinetCost = getBabyBassinetCost();\n                }\n                vm.loadingSeatMap = false;\n\n                $timeout(function () {\n                    jQuery('.passengersSeatMap').find('.mCSB_container').css('top', seatMapContainerTopPosition);\n                });\n            }, function (resp) {\n                vm.seatMapError = resp.error;\n                vm.loadingSeatMap = false;\n            });\n        }\n\n    }\n\n    function getBabyBassinetCost(paxNum, flightNum) {\n        var babyBassinetItem;\n        if (\n            vm.babyBassinetService &&\n            vm.babyBassinetService.itemsByPassengerSegments &&\n            vm.babyBassinetService.itemsByPassengerSegments[vm.selectedPassenger] &&\n            vm.babyBassinetService.itemsByPassengerSegments[vm.selectedPassenger][vm.selectedFlight]\n        ) {\n            babyBassinetItem = utils.getFirstNotEmptySubListItem(vm.babyBassinetService.itemsByPassengerSegments[vm.selectedPassenger][vm.selectedFlight]);\n            if (\n                babyBassinetItem &&\n                babyBassinetItem.price &&\n                babyBassinetItem.currency\n            ) {\n                return {\n                    value: babyBassinetItem.price,\n                    currency: babyBassinetItem.currency\n                }\n            }\n        }\n    }\n\n    function checkExistSeatsWithBabyBassinetBySeatMap(seatMap) {\n        var hasBabyBassinet = false;\n        if (seatMap && seatMap.decks) {\n            seatMap.decks.forEach(function (deck) {\n                if (deck && deck.cabins) {\n                    deck.cabins.forEach(function (cabin) {\n                        if (cabin && cabin.rows) {\n                            cabin.rows.forEach(function (row) {\n                                if (row && row.chairs) {\n                                    row.chairs.forEach(function (chair) {\n                                        if (checkExistSeatsWithBabyBassinetByChair(chair)) {\n                                            hasBabyBassinet = true;\n                                        }\n                                    });\n                                }\n                            });\n                        }\n                    });\n                }\n            });\n        }\n        return hasBabyBassinet;\n    }\n\n    function checkExistSeatsWithBabyBassinetByChair(chair) {\n        var hasBabyBassinet = false;\n        if (chair && chair.properties) {\n            chair.properties.forEach(function (prop) {\n                if (prop === 'babyBassinet') {\n                    hasBabyBassinet = true\n                    chair.hasBabyBassinet = true\n                }\n            });\n        }\n        return hasBabyBassinet;\n    }\n\n    function setPassengerFlightSeat(chair, cabinAllowed, rowNumber) {\n        var babyBassinetItem,\n            paxId = vm.orderInfo.passengers[vm.selectedPassenger].id,\n            segId = vm.orderInfo.plainFlights[vm.selectedFlight].id;\n        if (!vm.locked) {\n            if (chair.available && cabinAllowed) {\n                //setSeatMapContainerTopPosition();\n\n                seatMapContainerTopPosition = jQuery('.passengersSeatMap').find('.mCSB_container').css('top');\n\n                vm.modifyError = false;\n\n                backend.modifyExtraService({\n                    code: 'seat',\n                    passenger_id: paxId,\n                    segment_id: segId,\n                    value: rowNumber + chair.number,\n                    subgroup: vm.service.commonSubgroup,\n                    rfisc: chair.rfisc || '',\n                    service_type: 'F'\n                }).then(function () {\n                    updateSeatMap();\n\n                    if (checkExistSeatsWithBabyBassinetByChair(chair)) {\n                        if (\n                            vm.babyBassinetService &&\n                            vm.babyBassinetService.itemsByPassengerSegments &&\n                            vm.babyBassinetService.itemsByPassengerSegments[vm.selectedPassenger] &&\n                            vm.babyBassinetService.itemsByPassengerSegments[vm.selectedPassenger][vm.selectedFlight]\n                        ) {\n                            babyBassinetItem = utils.getFirstNotEmptySubListItem(vm.babyBassinetService.itemsByPassengerSegments[vm.selectedPassenger][vm.selectedFlight]);\n                            if (\n                                babyBassinetItem &&\n                                babyBassinetItem.serviceType &&\n                                babyBassinetItem.rfisc\n                            ) {\n                                backend.modifyExtraService({\n                                    code: 'babyBassinet',\n                                    passenger_id: paxId,\n                                    segment_id: segId,\n                                    subgroup: vm.babyBassinetService.commonSubgroup,\n                                    rfisc: babyBassinetItem.rfisc,\n                                    service_type: babyBassinetItem.serviceType\n                                })\n                            }\n                        }\n                    } else {\n                        removeBabyBassinetIfExist(paxId, segId);\n                    }\n                }, function (resp) {\n                    if (resp.error) {\n                        vm.modifyError = resp.error;\n                    }\n                });\n            }\n        }\n    }\n\n    function updateSunInfoByFlights() {\n        vm.sunInfoByFlights = [];\n        vm.orderInfo.plainFlights.forEach(function (flight, flightNum) {\n            backend.sunInfo(\n                flight.origincity,\n                flight.departuredate,\n                flight.departuretime,\n                flight.destinationcity,\n                flight.arrivaldate,\n                flight.arrivaltime\n            ).then(function (resp) {\n                vm.sunInfoByFlights[flightNum] = resp;\n            });\n        });\n    }\n\n    function getFirstAvailableFlightNum() {\n        var i;\n        for (i = 0; i < vm.orderInfo.plainFlights.length; i++) {\n            if (vm.service.availableBySegments[i]) {\n                return i;\n            }\n        }\n        return -1;\n    }\n\n    function getFirstAvailablePassengerNum(flightNum) {\n        var i;\n        if (vm.service.availableByPassengerSegments) {\n            for (i = 0; i < vm.orderInfo.passengers.length; i++) {\n                if (vm.service.availableByPassengerSegments[i][flightNum]) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    }\n\n    function scrollToStart() {\n        passengersTableContainer.scrollTo(0);\n    }\n\n    function scrollToEnd() {\n        passengersTableContainer.scrollTo(passengersTableContainer[0].scrollWidth);\n    }\n\n    function mobileTableScrollHandler() {\n        var scrollLeft = passengersTableContainer[0].scrollLeft,\n            scrollWidth = passengersTableContainer[0].scrollWidth,\n            clientWidth = passengersTableContainer[0].clientWidth,\n            scrollRight = scrollWidth - clientWidth - scrollLeft;\n        vm.canScrollRight = (scrollRight !== 0);\n        vm.canScrollLeft = (scrollLeft !== 0);\n        $scope.$apply();\n    }\n\n    function getAvailablePassengersCountWrap(availableByPassengerSegments) {\n        var count = utils.getAvailablePassengersCount(availableByPassengerSegments);\n        return count + vm.orderInfo.passengers.filter(function (pax) {\n            return !pax.hasSeats;\n        }).length;\n    }\n\n    function removePassengerFlightSeat(passengerNum, flightNum) {\n        var paxId = vm.orderInfo.passengers[passengerNum].id,\n            segId = vm.orderInfo.plainFlights[flightNum].id;\n        if (\n            !vm.locked && !backend.checkServiceRemovalProhibited('seat', passengerNum, flightNum)\n        ) {\n            vm.modifyError = false;\n\n            backend.removeExtraService({\n                code: 'seat',\n                passenger_id: paxId,\n                segment_id: segId\n            }).then(function () {\n                removeBabyBassinetIfExist(paxId, segId);\n                if (vm.selectedFlight === flightNum) {\n                    updateSeatMap();\n                }\n            }, function (resp) {\n                if (resp.error) {\n                    vm.modifyError = resp.error;\n                }\n            });\n\n\n        }\n    }\n\n    function removeBabyBassinetIfExist(paxId, segId) {\n        if (\n            vm.orderInfo.editableExtraServicesHeap &&\n            _.findWhere(\n                vm.orderInfo.editableExtraServicesHeap,\n                {\n                    groupCode: 'babyBassinet',\n                    mainSegmentId: segId,\n                    passengerId: paxId\n                }\n            )\n        ) {\n            backend.removeExtraService({\n                code: 'babyBassinet',\n                passenger_id: paxId,\n                segment_id: segId\n            })\n        }\n    }\n\n    function getSelectedPassengerFlightMeal(passengerNum, flightNum) {\n        var result,\n            passengerSegmentServices,\n            passengerSegmentSeat;\n        if (vm.orderInfo.editableExtraServicesByPassengers) {\n            if (vm.orderInfo.editableExtraServicesByPassengers[passengerNum]) {\n                /* jshint maxlen: 150 */\n                passengerSegmentServices = vm.orderInfo.editableExtraServicesByPassengers[passengerNum].passengerSegmentServices[flightNum];\n                if (passengerSegmentServices) {\n                    passengerSegmentSeat = _.findWhere(passengerSegmentServices, { code: 'seat' });\n                    if (passengerSegmentSeat) {\n                        result = passengerSegmentSeat.serviceItem;\n                    }\n                }\n            }\n        }\n        return result;\n    }\n\n    function checkAllChoose() {\n\n      for (var i = 0; i < vm.orderInfo.plainFlights.length; i++) {\n        for (var j = 0; j < vm.orderInfo.passengers.length; j++) {\n          if (getSelectedPassengerFlightMeal(j, i)) {\n            return true\n          }\n        }\n      }\n\n      return false;\n\n    }\n\n}\n\n},{}],6:[function(require,module,exports){\n\"use strict\";\n\nangular.module('app').component('orderRossiya', {\n    templateUrl: 'components/order-rossiya/order-rossiya.html',\n    controller: ['$window', '$timeout', 'backend', 'utils', 'redirect', 'fancyboxTools', OrderRossiyaController],\n    controllerAs: 'vm',\n    bindings: {\n        pnrOrTicketNumber: '=num',\n        lastName: '=lastname'\n    }\n});\n\nfunction OrderRossiyaController($window, $timeout, backend, utils, redirect, fancyboxTools) {\n\n    var vm = this;\n    vm.loading = true;\n    vm.errorMessage = false;\n    vm.openExchange = redirect.goToExchange;\n    vm.openRefund = redirect.goToRefund;\n    vm.openAddServices = redirect.goToAddServices;\n    vm.suffixCount = utils.suffixCount;\n    vm.retryPayment = retryPayment;\n    vm.bindOrder = bindOrder;\n    vm.checkAllPassengersHavePaidService = checkAllPassengersHavePaidService;\n    vm.clearSession = clearSession;\n\n    backend.searchOrder(vm.pnrOrTicketNumber, vm.lastName).then(function (orderInfo) {\n\n        var resultParam = utils.getParamFromLocation('result');\n\n        vm.orderInfo = orderInfo;\n\n        if (\n            vm.orderInfo.header &&\n            (\n                vm.orderInfo.header.status === 'being_paid' ||\n                vm.orderInfo.header.status === 'being_paid_for_exchange'\n            )\n        ) {\n            if (resultParam === 'success') {\n                backend.waitPayment(vm.orderInfo.header.regnum, vm.lastName).then(function () {\n                    $window.location = './order?pnr=' + vm.orderInfo.header.regnum + '&lastName=' + vm.lastName + '&result=success';\n                    return;\n                }, function () {\n                    vm.loading = false;\n                });\n            } else {\n                if (!vm.orderInfo.hasFailedServices) {\n                    vm.showPaymentFrame = true;\n                }\n                vm.loading = false;\n            }\n        } else {\n            vm.loading = false;\n        }\n\n        if (\n            vm.orderInfo.hasFailedServices &&\n            !resultParam &&\n            vm.orderInfo.header &&\n            (\n                vm.orderInfo.header.status === 'being_paid' ||\n                vm.orderInfo.header.status === 'booked'\n            )\n        ) {\n            $timeout(function () {\n                fancyboxTools.openHandler('popupRemovedServicesWarning', false, {\n                    submitCallback: function () {\n                        if (vm.orderInfo.paymentRedirectTo) {\n                            vm.showPaymentFrame = true;\n                        }\n                        vm.ignoreFailedServices = true;\n                    },\n                    disableOutsideCloseClick: true\n                });\n            });\n        }\n\n\n        if (\n            backend.getParam('ffp.enable') &&\n            (vm.orderInfo.hasBonusCard || vm.orderInfo.ffpSumm)\n        ) {\n            backend.ffpBonus().then(function (resp) {\n                vm.ffpBonus = resp.total || 0;\n            });\n        }\n\n    }, function (resp) {\n        vm.loading = false;\n        vm.errorMessage = resp.error;\n    });\n\n    function retryPayment() {\n        vm.loading = true;\n        backend.retryRegister().then(function (resp) {\n            if (resp.lastName && resp.pnr) {\n                $window.location = './order?pnr=' + resp.pnr + '&lastName=' + resp.lastName;\n            } else {\n                vm.loading = false;\n            }\n        }, function (resp) {\n            vm.loading = false;\n            vm.errorMessage = resp.error;\n        });\n    }\n\n    function bindOrder() {\n        if (!vm.orderInfo.header || !vm.orderInfo.header.regnum) {\n            return;\n        }\n        vm.loading = true;\n        backend.bindOrder(vm.orderInfo.header.regnum, vm.lastName).then(function () {\n            vm.loading = false;\n            vm.orderInfo.bindAlowed = false;\n            vm.showBindOrderSuccessMessage = true;\n            $timeout(function () {\n                vm.showBindOrderSuccessMessage = false;\n            }, 10000);\n        }, function () {\n            vm.loading = false;\n            vm.showBindOrderFailMessage = true;\n            $timeout(function () {\n                vm.showBindOrderFailMessage = false;\n            }, 10000);\n        });\n    }\n\n    function checkAllPassengersHavePaidService(name) {\n        var result = true;\n        vm.orderInfo.passengers.forEach(function (passenger, passengerNum) {\n            if (\n\t\t\t\tvm.orderInfo.allExtraServicesByPassengers &&\n\t\t\t\tvm.orderInfo.allExtraServicesByPassengers[passengerNum] &&\n\t\t\t\tvm.orderInfo.allExtraServicesByPassengers[passengerNum].passengerSegmentServices\n\t\t\t) {\n\t\t\t\tvm.orderInfo.allExtraServicesByPassengers[passengerNum].passengerSegmentServices.forEach(\n\t\t\t\t\tfunction (segmentServices) {\n\t\t\t\t\t\tvar segmentWantedService = _.findWhere(segmentServices, { code: name });\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!segmentServices || !segmentWantedService ||\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tsegmentWantedService &&\n\t\t\t\t\t\t\t\tsegmentWantedService.serviceItem &&\n\t\t\t\t\t\t\t\tsegmentWantedService.serviceItem.status !== 'ISSUED_WITH_EMD'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tresult = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tresult = false;\n\t\t\t}\n        });\n        return result;\n    }\n\n    function clearSession() {\n        backend.clearSession().then(function () {\n            redirect.goToSearchOrder();\n        });\n    }\n\n}\n\n},{}],7:[function(require,module,exports){\n\"use strict\";\nangular.module('app').component('popupMealRossiya', {\n\ttemplateUrl: 'components/popup-meal-rossiya/popup-meal-rossiya.html',\n\tcontroller: ['utils', '$scope', PopupMealRossiyaController],\n\tcontrollerAs: 'vm',\n\tbindings: {\n\t\tmealMenu: '=menu',\n\t\tpassenger: '=passenger',\n\t\tcurrentPassengerIndex: '=',\n\t\tcurrentFlightIndex: '=',\n\t\tpassengers: '=passengers',\n\t\tflight: '=flight',\n\t\tmealCountChangeHandler: '=handler',\n\t\tclearPassengerFlightMeal: '&remove',\n\t\tgetPassengerFlightMeal: '=get',\n\t\tsubgroups: '=subgroups',\n\t\tmealImagesPath: '=path',\n\t\tservice: '=',\n\t\tselectFlightPassenger: '=select',\n\t\tgetLimitStatus: '=limit',\n\t\tmealSelect: '=',\n\t\tgetMealInfo: '='\n\t}\n});\n\nfunction PopupMealRossiyaController(utils, $scope) {\n\n\tvar vm = this;\n\tvm.close = jQuery.fancybox.close;\n\tvm.mealMenuSubgroupMobileChange = mealMenuSubgroupMobileChange;\n\tvm.mealMenuSubgroup = false;\n\tvm.mealMenuSubgroupMobile = 'false';\n\tvm.subgroupItems = utils.createOptionsForUiSelect(vm.subgroups, 'all');\n\tvm.switchNext = switchNext;\n\tvm.switchPrev = switchPrev;\n\tvm.arrayString = arrayString;\n\tvm.getGroupMeal = getGroupMeal;\n\n\tvm.detailedView = {open: false};\n\tvm.setItemIndex = setItemIndex;\n\tvm.closeItemPopup = closeItemPopup;\n\tvm.nextItemPopup = nextItemPopup;\n\tvm.prevItemPopup = prevItemPopup;\n\n\tvm.totalAmount = totalAmount;\n\n\tfunction setItemIndex(subgroupIndex, mealIndex) {\n\n\t\tvm.detailedView.open = true;\n\t\tvm.detailedView.subgroupIndex = subgroupIndex;\n\t\tvm.detailedView.mealIndex = mealIndex;\n\n\t}\n\n\tfunction closeItemPopup() {\n\t\tvm.detailedView.open = false;\n\t}\n\n\tfunction nextItemPopup() {\n\n\t\tvar countSubgroupIndex = vm.mealMenu.length - 1,\n\t\t\t\tcountMealIndex = vm.mealMenu[vm.detailedView.subgroupIndex].length - 1;\n\n\t\tif (\n\t\t\tvm.detailedView.subgroupIndex !== countSubgroupIndex &&\n\t\t\tvm.detailedView.mealIndex !== countMealIndex\n\t\t) {\n\t\t\t\tvm.detailedView.mealIndex++;\n\t\t} else if\n\t\t\t(\n\t\t\t\tvm.detailedView.subgroupIndex !== countSubgroupIndex &&\n\t\t\t\tvm.detailedView.mealIndex == countMealIndex\n\t\t\t) {\n\t\t\t\tvm.detailedView.mealIndex = 0;\n\t\t\t\tvm.detailedView.subgroupIndex++;\n\t\t} else if\n\t\t\t(\n\t\t\t\tvm.detailedView.subgroupIndex == countSubgroupIndex &&\n\t\t\t\tvm.detailedView.mealIndex !== countMealIndex\n\t\t\t) {\n\t\t\t\tvm.detailedView.mealIndex++;\n\t\t} else if\n\t\t\t(\n\t\t\t\tvm.detailedView.subgroupIndex == countSubgroupIndex &&\n\t\t\t\tvm.detailedView.mealIndex == countMealIndex\n\t\t\t) {\n\t\t\t\tvm.detailedView.mealIndex = 0;\n\t\t\t\tvm.detailedView.subgroupIndex = 0;\n\t\t}\n\t}\n\n\tfunction prevItemPopup() {\n\n\t\tif (\n\t\t\tvm.detailedView.subgroupIndex !== 0 &&\n\t\t\tvm.detailedView.mealIndex !== 0\n\t\t) {\n\t\t\t\tvm.detailedView.mealIndex--;\n\t\t} else if\n\t\t\t(\n\t\t\t\tvm.detailedView.subgroupIndex !== 0 &&\n\t\t\t\tvm.detailedView.mealIndex == 0\n\t\t\t) {\n\t\t\t\tvm.detailedView.subgroupIndex--;\n\t\t\t\tvm.detailedView.mealIndex = vm.mealMenu[vm.detailedView.subgroupIndex].length - 1;\n\t\t} else if\n\t\t\t(\n\t\t\t\tvm.detailedView.subgroupIndex == 0 &&\n\t\t\t\tvm.detailedView.mealIndex !== 0\n\t\t\t) {\n\t\t\t\tvm.detailedView.mealIndex--;\n\t\t} else if\n\t\t\t(\n\t\t\t\tvm.detailedView.subgroupIndex == 0 &&\n\t\t\t\tvm.detailedView.mealIndex == 0\n\t\t\t) {\n\t\t\t\tvm.detailedView.subgroupIndex = vm.mealMenu.length - 1;\n\t\t\t\tvm.detailedView.mealIndex = vm.mealMenu[vm.detailedView.subgroupIndex].length - 1;\n\t\t}\n\t}\n\n\tfunction setAvailablePassengers() {\n\t\tvm.availablePassengers = vm.passengers.filter(function (passenger, index) {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t\tvm.service.availableByPassengerSegments[index] &&\n\t\t\t\t\t\t\tvm.service.availableByPassengerSegments[index][vm.currentFlightIndex]\n\t\t\t\t\t);\n\t\t\t});\n\t}\n\n\t$scope.$watch('vm.currentFlightIndex', function () {\n\t\tsetAvailablePassengers();\n\t});\n\n\tfunction mealMenuSubgroupMobileChange() {\n\t\tif (vm.mealMenuSubgroupMobile === false) {\n\t\t\tvm.mealMenuSubgroup = false;\n\t\t} else {\n\t\t\tvm.mealMenuSubgroup = vm.mealMenuSubgroupMobile * 1;\n\t\t}\n\t}\n\n\tfunction switchNext() {\n\t\tvar successSwitch = false;\n\t\tfor (var i = vm.currentPassengerIndex + 1; i < vm.passengers.length; i++) {\n\t\t\tif (\n\t\t\t\tvm.service.availableByPassengerSegments[i] &&\n\t\t\t\tvm.service.availableByPassengerSegments[i][vm.currentFlightIndex]\n\t\t\t) {\n\t\t\t\tvm.selectFlightPassenger(vm.currentFlightIndex, i);\n\t\t\t\tsuccessSwitch = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!successSwitch) {\n\t\t\tfor (var j = 0; j < vm.passengers.length; j++) {\n\t\t\t\tif (\n\t\t\t\t\tvm.service.availableByPassengerSegments[j] &&\n\t\t\t\t\tvm.service.availableByPassengerSegments[j][vm.currentFlightIndex]\n\t\t\t\t) {\n\t\t\t\t\tvm.selectFlightPassenger(vm.currentFlightIndex, j);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction switchPrev() {\n\t\tvar successSwitch = false;\n\t\tfor (var i = vm.currentPassengerIndex - 1; i > -1; i--) {\n\t\t\tif (\n\t\t\t\tvm.service.availableByPassengerSegments[i] &&\n\t\t\t\tvm.service.availableByPassengerSegments[i][vm.currentFlightIndex]\n\t\t\t) {\n\t\t\t\tvm.selectFlightPassenger(vm.currentFlightIndex, i);\n\t\t\t\tsuccessSwitch = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!successSwitch) {\n\t\t\tfor (var j = vm.passengers.length - 1; j > -1; j--) {\n\t\t\t\tif (\n\t\t\t\t\tvm.service.availableByPassengerSegments[j] &&\n\t\t\t\t\tvm.service.availableByPassengerSegments[j][vm.currentFlightIndex]\n\t\t\t\t) {\n\t\t\t\t\tvm.selectFlightPassenger(vm.currentFlightIndex, j);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction arrayString(arrays) {\n\n\t\tif(!Array.isArray(arrays)) return;\n\n\t\tvar total = arrays.reduce(function(flat, current) {\n\t\t\treturn flat.concat(current);\n\t\t}, []);\n\n\t\tif(vm.mealMenuSubgroup === false ) return total;\n\n\t\treturn arrays;\n\t}\n\n\tfunction getGroupMeal(meal, arrays) {\n\n\t\tfor (var i = 0; i < arrays.length; i++) {\n\t\t\tfor(var j = 0; j < arrays[i].length; j++) {\n\t\t\t\tif (arrays[i][j]['rfisc'] == meal['rfisc']) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction totalAmount() {\n\t\tvm.mealMenu = vm.mealMenu || [];\n\n\t\tvar totalSumm = 0;\n\n\t\tfor (var i = 0; i < vm.mealMenu.length; i++) {\n\t\t\tfor(var j = 0; j < vm.mealMenu[i].length; j++) {\n\t\t\t\tif(vm.mealMenu[i][j].alreadySelectedCount) {\n\t\t\t\t\ttotalSumm += ( vm.mealMenu[i][j].price * vm.mealMenu[i][j].alreadySelectedCount );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn totalSumm;\n\t}\n\n}\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\nrequire('./components/popup-meal-rossiya/popup-meal-rossiya');\nrequire('./components/es-meal-rossiya/es-meal-rossiya');\nrequire('./components/es-seat-rossiya/es-seat-rossiya');\nrequire('./components/order-rossiya/order-rossiya');\nrequire('./components/baby-bassinet-icon/baby-bassinet-icon');\nrequire('./components/baby-bassinet-icon-legend/baby-bassinet-icon-legend');\nrequire('./components/baby-bassinet-icon-tooltip/baby-bassinet-icon-tooltip');\n},{\"./components/baby-bassinet-icon-legend/baby-bassinet-icon-legend\":1,\"./components/baby-bassinet-icon-tooltip/baby-bassinet-icon-tooltip\":2,\"./components/baby-bassinet-icon/baby-bassinet-icon\":3,\"./components/es-meal-rossiya/es-meal-rossiya\":4,\"./components/es-seat-rossiya/es-seat-rossiya\":5,\"./components/order-rossiya/order-rossiya\":6,\"./components/popup-meal-rossiya/popup-meal-rossiya\":7}]},{},[8]);\n"]}