!function e(s,r,n){function a(l,i){if(!r[l]){if(!s[l]){var o="function"==typeof require&&require;if(!i&&o)return o(l,!0);if(t)return t(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var g=r[l]={exports:{}};s[l][0].call(g.exports,function(e){var r=s[l][1][e];return a(r?r:e)},g,g.exports,e,s,r,n)}return r[l].exports}for(var t="function"==typeof require&&require,l=0;l<n.length;l++)a(n[l]);return a}({1:[function(e,s,r){"use strict";function n(e,s,r,n){function a(){h.locked||r.checkServiceRemovalProhibited("meal")||(h.service.active=!h.service.active,h.service.active?l():r.removeExtraService({code:"meal"}))}function t(e,s){h.selectedFlight=e,h.selectedPassenger=s,i()}function l(){h.selectedFlight=d(),h.selectedPassenger=p(h.selectedFlight),i()}function i(){h.mealMenu=h.service.itemsByPassengerSegments[h.selectedPassenger][h.selectedFlight],h.mealMenuSubgroup=!1}function o(e,s){var n=g(h.selectedPassenger,h.selectedFlight),a={code:"meal",passenger_id:h.orderInfo.passengers[h.selectedPassenger].id,segment_id:h.orderInfo.plainFlights[h.selectedFlight].id,subgroup:h.service.subgroups[e],service_type:s.serviceType,rfisc:s.rfisc};h.locked||(n&&!r.checkServiceRemovalProhibited("meal",h.selectedPassenger,h.selectedFlight)?r.removeExtraService({code:"meal",passenger_id:h.orderInfo.passengers[h.selectedPassenger].id,segment_id:h.orderInfo.plainFlights[h.selectedFlight].id,service_type:n.serviceType,rfisc:n.rfisc},!0).then(function(){r.modifyExtraService(a)}):r.modifyExtraService(a))}function c(e,s){h.locked||r.checkServiceRemovalProhibited("meal",e,s)||r.removeExtraService({code:"meal",passenger_id:h.orderInfo.passengers[e].id,segment_id:h.orderInfo.plainFlights[s].id})}function g(e,s){var r,n,a;return h.orderInfo.editableExtraServicesByPassengers&&h.orderInfo.editableExtraServicesByPassengers[e]&&(n=h.orderInfo.editableExtraServicesByPassengers[e].passengerSegmentServices[s],n&&(a=_.findWhere(n,{code:"meal"}),a&&(r=a.serviceItem))),r}function u(){P.scrollTo(0)}function v(){P.scrollTo(P[0].scrollWidth)}function m(){var s=P[0].scrollLeft,r=P[0].scrollWidth,n=P[0].clientWidth,a=r-n-s;h.canScrollRight=0!==a,h.canScrollLeft=0!==s,e.$apply()}function d(){var e;for(e=0;e<h.orderInfo.plainFlights.length;e++)if(h.service.availableBySegments[e])return e;return-1}function p(e){var s;if(h.service.availableByPassengerSegments)for(s=0;s<h.orderInfo.passengers.length;s++)if(h.service.availableByPassengerSegments[s][e])return s;return-1}function f(){for(var e=0,s=0,r=0;r<h.service.availableByPassengerSegments.length;r++)for(var n=0;n<h.service.availableByPassengerSegments[r].length;n++)h.service.availableByPassengerSegments[r][n]&&e++;for(var r=0;r<h.orderInfo.plainFlights.length;r++)for(var n=0;n<h.orderInfo.passengers.length;n++)g(n,r)&&s++;return s==e}var h=this,P=s.find("div.passengersTableContainer");h.switchService=a,h.selectFlightPassenger=t,h.selectFirstAvailablePassengerFlight=l,h.setPassengerFlightMeal=o,h.removePassengerFlightMeal=c,h.getSelectedPassengerFlightMeal=g,h.scrollToStart=u,h.scrollToEnd=v,h.checkAllChoose=f,h.hasAlias=r.hasAlias,h.getAvailablePassengersCount=n.getAvailablePassengersCount,h.checkServiceRemovalProhibited=r.checkServiceRemovalProhibited,h.canScrollRight=!0,h.canScrollLeft=!1,h.selectedFlight=0,h.selectedPassenger=0,r.getParam("site.externalStorageBaseUrl")?h.mealImagesPath=r.getParam("site.externalStorageBaseUrl")+"/img/content/meal":h.mealImagesPath="./themes/websky/assets/static/img/content/meal",r.addOrderInfoListener(function(e){h.orderInfo=e},!1,!0),e.$watch("vm.service",function(){h.mealMenu&&i()}),P.on("scroll",m),h.service.active&&i()}angular.module("app").component("esMealRossiya",{templateUrl:"components/es-meal-rossiya/es-meal-rossiya.html",controller:["$scope","$element","backend","utils",n],controllerAs:"vm",bindings:{service:"=service",locked:"=locked"}})},{}],2:[function(e,s,r){"use strict";function n(e){function s(){a.mealMenuSubgroupMobile===!1?a.mealMenuSubgroup=!1:a.mealMenuSubgroup=1*a.mealMenuSubgroupMobile}function r(){for(var e=!1,s=a.currentPassengerIndex+1;s<a.passengers.length;s++)if(a.service.availableByPassengerSegments[s]&&a.service.availableByPassengerSegments[s][a.currentFlightIndex]){a.selectFlightPassenger(a.currentFlightIndex,s),e=!0;break}if(!e)for(var r=0;r<a.passengers.length;r++)if(a.service.availableByPassengerSegments[r]&&a.service.availableByPassengerSegments[r][a.currentFlightIndex]){a.selectFlightPassenger(a.currentFlightIndex,r);break}}function n(){for(var e=!1,s=a.currentPassengerIndex-1;s>-1;s--)if(a.service.availableByPassengerSegments[s]&&a.service.availableByPassengerSegments[s][a.currentFlightIndex]){a.selectFlightPassenger(a.currentFlightIndex,s),e=!0;break}if(!e)for(var r=a.passengers.length-1;r>-1;r--)if(a.service.availableByPassengerSegments[r]&&a.service.availableByPassengerSegments[r][a.currentFlightIndex]){a.selectFlightPassenger(a.currentFlightIndex,r);break}}var a=this;a.close=jQuery.fancybox.close,a.mealMenuSubgroupMobileChange=s,a.mealMenuSubgroup=!1,a.mealMenuSubgroupMobile="false",a.subgroupItems=e.createOptionsForUiSelect(a.subgroups,"all"),a.switchNext=r,a.switchPrev=n,a.availablePassengers=a.passengers.filter(function(e,s){return a.service.availableByPassengerSegments[s]&&a.service.availableByPassengerSegments[s][a.currentFlightIndex]})}angular.module("app").component("popupMealRossiya",{templateUrl:"components/popup-meal-rossiya/popup-meal-rossiya.html",controller:["utils",n],controllerAs:"vm",bindings:{mealMenu:"=menu",passenger:"=passenger",currentPassengerIndex:"=",currentFlightIndex:"=",passengers:"=passengers",flight:"=flight",setPassengerFlightMeal:"=handler",clearPassengerFlightMeal:"&remove",getPassengerFlightMeal:"=get",subgroups:"=subgroups",mealImagesPath:"=path",service:"=",selectFlightPassenger:"=select"}})},{}],3:[function(e,s,r){"use strict";console.log("app: ",angular.module("app")),e("./components/popup-meal-rossiya/popup-meal-rossiya"),e("./components/es-meal-rossiya/es-meal-rossiya")},{"./components/es-meal-rossiya/es-meal-rossiya":1,"./components/popup-meal-rossiya/popup-meal-rossiya":2}]},{},[3]);
//# sourceMappingURL=controllers-rossia.js.map
